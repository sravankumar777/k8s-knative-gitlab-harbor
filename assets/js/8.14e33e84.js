(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{214:function(t,a,e){t.exports=e.p+"assets/img/Tekton_Dashboard.258cb264.png"},228:function(t,a,e){"use strict";e.r(a);var s=e(10),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"install-knative"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-knative"}},[t._v("#")]),t._v(" Install Knative")]),t._v(" "),s("p",[t._v("Set Knative version variable:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("KNATIVE_VERSION")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v0.11.0"')]),t._v("\n")])])]),s("p",[t._v("Install Knative:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("kubectl apply --selector knative.dev/crd-install"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --filename https://github.com/knative/serving/releases/download/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${KNATIVE_VERSION}")]),t._v("/serving.yaml "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --filename https://github.com/knative/eventing/releases/download/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${KNATIVE_VERSION}")]),t._v("/release.yaml "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --filename https://github.com/knative/serving/releases/download/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${KNATIVE_VERSION}")]),t._v("/monitoring.yaml\nkubectl apply "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --filename https://github.com/knative/serving/releases/download/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${KNATIVE_VERSION}")]),t._v("/serving.yaml "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --filename https://github.com/knative/eventing/releases/download/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${KNATIVE_VERSION}")]),t._v("/release.yaml "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --filename https://github.com/knative/serving/releases/download/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${KNATIVE_VERSION}")]),t._v("/monitoring.yaml\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v("\n")])])]),s("p",[t._v("Install Tekton with Dashboard (do not increase Tekton version above 0.8.0):")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("kubectl apply --filename https://github.com/tektoncd/pipeline/releases/download/v0.8.0/release.yaml\nkubectl apply --filename https://github.com/tektoncd/dashboard/releases/download/v0.3.0/dashboard-latest-release.yaml\n")])])]),s("p",[t._v("Install Tekton Triggers:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("kubectl apply --filename https://github.com/tektoncd/triggers/releases/download/v0.1.0/release.yaml\n")])])]),s("p",[t._v("Export Knative services ("),s("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Prometheus"),s("OutboundLink")],1),t._v(" and\n"),s("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana"),s("OutboundLink")],1),t._v(") to be visible externally:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" EOF "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" kubectl apply -f -\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: knative-services-gateway\n  namespace: knative-monitoring\nspec:\n  selector:\n    istio: ingressgateway\n  servers:\n  - port:\n      number: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n      name: http-knative-services\n      protocol: HTTP\n    hosts:\n    - knative-grafana."),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("\n    - knative-prometheus."),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("\n    - knative-tekton."),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("\n  - port:\n      number: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("\n      name: https-knative-services\n      protocol: HTTPS\n    hosts:\n    - knative-grafana."),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("\n    - knative-prometheus."),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("\n    - knative-tekton."),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v("\n    tls:\n      credentialName: ingress-cert-"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LETSENCRYPT_ENVIRONMENT}")]),t._v("\n      mode: SIMPLE\n      privateKey: sds\n      serverCertificate: sds\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: grafana-virtual-service\n  namespace: knative-monitoring\nspec:\n  hosts:\n  - "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"knative-grafana.'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v('"')]),t._v("\n  gateways:\n  - knative-services-gateway\n  http:\n  - route:\n    - destination:\n        host: grafana.knative-monitoring.svc.cluster.local\n        port:\n          number: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30802")]),t._v("\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: prometheus-virtual-service\n  namespace: knative-monitoring\nspec:\n  hosts:\n  - "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"knative-prometheus.'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v('"')]),t._v("\n  gateways:\n  - knative-services-gateway\n  http:\n  - route:\n    - destination:\n        host: prometheus-system-np.knative-monitoring.svc.cluster.local\n        port:\n          number: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: tekton-virtual-service\n  namespace: knative-monitoring\nspec:\n  hosts:\n  - "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"knative-tekton.'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),t._v('"')]),t._v("\n  gateways:\n  - knative-services-gateway\n  http:\n  - route:\n    - destination:\n        host: tekton-dashboard.tekton-pipelines.svc.cluster.local\n        port:\n          number: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9097")]),t._v("\nEOF\n")])])]),s("p",[t._v("Tekton Dashboard:")]),t._v(" "),s("p",[s("img",{attrs:{src:e(214),alt:"Tekton Dashboard",title:"Tekton Dashboard"}})]),t._v(" "),s("p",[t._v("Set up a custom domain for Knative:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" EOF "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" kubectl apply -f -\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: config-domain\n  namespace: knative-serving\ndata:\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${MY_DOMAIN}")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\nEOF\n")])])]),s("p",[t._v("Changing the controller deployment is needed if you are not using the valid\ncertificates (self-signed):")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LETSENCRYPT_ENVIRONMENT}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"staging"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n  kubectl --namespace knative-serving create secret generic customca --from-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("customca.crt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tmp/fakelerootx1.pem\n  kubectl patch deployment controller --namespace knative-serving --patch "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n    {\n        '),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("spec"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": {\n            "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("template"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": {\n                "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("spec"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": {\n                    "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("containers"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": [{\n                        "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("env"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": [{\n                            "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("SSL_CERT_DIR"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(",\n                            "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("value"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("/etc/customca"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("\n                        }],\n                        "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("controller"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(",\n                        "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("volumeMounts"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": [{\n                            "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("mountPath"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("/etc/customca"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(",\n                            "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("customca"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("\n                        }]\n                    }],\n                    "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("volumes"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": [{\n                        "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("customca"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(",\n                        "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("secret"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": {\n                            "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("defaultMode"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": 420,\n                            "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("secretName"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("customca"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('\n                        }\n                    }]\n                }\n            }\n        }\n    }"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n")])])]),s("h2",{attrs:{id:"enable-automatic-tls-certificate-provisioning-for-knative"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#enable-automatic-tls-certificate-provisioning-for-knative"}},[t._v("#")]),t._v(" Enable automatic TLS certificate provisioning for Knative")]),t._v(" "),s("p",[t._v("Install "),s("code",[t._v("networking-certmanager")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("kubectl apply --filename https://github.com/knative/serving/releases/download/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${KNATIVE_VERSION}")]),t._v("/serving-cert-manager.yaml\n")])])]),s("p",[t._v("Update your "),s("code",[t._v("config-certmanager")]),t._v(" ConfigMap in the "),s("code",[t._v("knative-serving")]),t._v(" namespace to\ndefine your new ClusterIssuer configuration and your your DNS provider:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" EOF "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" kubectl apply -f -\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: config-certmanager\n  namespace: knative-serving\n  labels:\n    networking.knative.dev/certificate-provider: cert-manager\ndata:\n  issuerRef: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    kind: ClusterIssuer\n    name: letsencrypt-"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LETSENCRYPT_ENVIRONMENT}")]),t._v("-dns\n  solverConfig: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n    dns01:\n      provider: aws-route53\nEOF\n")])])]),s("p",[t._v("Update the "),s("code",[t._v("config-network")]),t._v(" ConfigMap in the "),s("code",[t._v("knative-serving")]),t._v(" namespace to enable\n"),s("code",[t._v("autoTLS")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" EOF "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" kubectl apply -f -\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: config-network\n  namespace: knative-serving\ndata:\n  autoTLS: Enabled\n  httpProtocol: Enabled\nEOF\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);